
# JAM style makefile for integer interpolation code, cctiff etc.

#PREF_CCFLAGS 	+= $(CCOPTFLAG) ;		# Turn optimisation on
PREF_CCFLAGS	    += $(CCDEBUGFLAG) ;		# Debugging flags
#PREF_CCFLAGS 	+= $(CCPROFFLAG) ;		# Profile flags
PREF_LINKFLAGS	+= $(LINKDEBUGFLAG) ;	# Link debugging flags
#PREF_LINKFLAGS	+= $(LINKPROFFLAG) ;    # Profile flags
#PREF_CCFLAGS	+= $(CCHEAPDEBUG) ;		# Heap Debugging flags

#Products
Libraries = libimdi ;
Executables = cctiff greytiff ;
Headers = imdi.h ;

#Install
InstallBin ../bin : $(Executables) ;
#InstallFile ../h : $(Headers) ;
#InstallLib ../lib : $(Libraries) ;

HDRS = ../h ../numlib ;
LINKLIBS = ../numlib/libnum ;

# imdi low level cgen test code
Main ctest : ctest.c cgen.c ;

# make imdi code program
Main imdi_make : imdi_make.c imdi_gen.c cgen.c ;

# GenFile source.c : program args ;	make custom file
# Generate all the kernel files
GenFileND imdi_k.h : imdi_make -d [ NormPaths $(DOT) ] ;

# imdi library
Library libimdi : imdi.c imdi_tab.c ;

HDRS += ../icc ../numlib ;
LINKLIBS = $(LINKLIBS) libimdi ../icc/libicc ../numlib/libnum ;

# imdi test code
Main itest : itest.c refi.c : : : ../rspl : : ../rspl/librspl ;

# TIFF file color correction utlity
Main cctiff : cctiff.c : : : ../xicc $(TIFFINC) : : ../xicc/libxutils $(TIFFLIB) ;

# Old TIFF file color correction utlity
#Main cctiffo : cctiffo.c : : : $(TIFFINC) : : $(TIFFLIB) ;

# TIFF file monochrome conversion utlity
#Main greytiff : greytiff.c ;
Main greytiff : greytiff.c : : : ../spectro ../xicc ../gamut ../rspl ../cgats $(TIFFINC)
              : : ../xicc/libxicc ../gamut/libgamut ../rspl/librspl ../cgats/libcgats $(TIFFLIB) ;

# ssort generation code
#Main ssort : ssort.c ;

#Main shsort : shsort.c ;

# code generated by shsort
#Main ttt : ttt.c ;

if $(BUILD_JUNK) {

	CCFLAGS 	+= -msse3 ;

	Main tvec : tvec.c ;
	Main tvec2 : tvec2.c ;

	# test code
	Main tsort : tsort.c ;
}

